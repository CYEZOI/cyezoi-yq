(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{8034:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userInfo",function(){return r(4953)}])},8166:function(e,n,r){"use strict";r.d(n,{b:function(){return d}});var s=r(4961),t=r(5139);class d{static async request_url(e,n,r,d){let a=new URLSearchParams(r);return a.append("lang",localStorage.getItem("language")||"en"),a.append("token",localStorage.getItem("token")||""),fetch("/api/"+(n+=(n.includes("?")?"&":"?")+a.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(e=>(e.success?(d.showSuccess&&s.X.emit("newAlert",{message:e.message,variant:"success"}),d.success&&d.success(e.result)):(d.hideFailure||s.X.emit("newAlert",{message:e.message,variant:"danger"}),d.failure&&d.failure(e.result)),e.result)).catch(e=>{d.hideError||s.X.emit("newAlert",{message:(0,t.t)("networkError"),variant:"danger"}),d.error&&d.error(e)})}static async request_body(e,n,r,d){fetch("/api/"+n,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:r.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""})}).then(e=>e.json()).then(e=>{e.success?(d.showSuccess&&s.X.emit("newAlert",{message:e.message,variant:"success"}),d.success&&d.success(e.result)):(d.hideFailure||s.X.emit("newAlert",{message:e.message,variant:"danger"}),d.failure&&d.failure(e.result))}).catch(e=>{d.hideError||s.X.emit("newAlert",{message:(0,t.t)("networkError"),variant:"danger"}),d.error&&d.error(e)})}static async Get(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.request_url("GET",e,n,r)}static async Post(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.request_body("POST",e,n,r)}static async Put(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.request_body("PUT",e,n,r)}static async Delete(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.request_url("DELETE",e,n,r)}static async SWRGet(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,s)=>{d.Get(e,n,{success:e=>r(e),failure:e=>s(e),error:e=>s(e)})})}static success(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:n,result:r}),e.end())}static failure(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:n,result:{}}),e.end())}}},4953:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return I}});var s=r(2676),t=r(7976),d=r.n(t),a=r(5324),l=r(1228),i=r(9722),u=r(8166),o=r(3334),c=r(4703),m=r(4018),h=r(8801),p=r(5271),g=r(9505);function I(){var e,n,r,t,I,v,x;let{t:b}=a.default,[j,y]=(0,p.useState)("changeInfo"),[Z,w]=(0,p.useState)(""),{data:f}=(0,g.ZP)(Z?"user?userIdList="+Z:null,u.b.SWRGet),{data:S}=(0,g.ZP)(()=>f?"student?studentIdList="+f.user.map(e=>e.studentId).join(","):null,u.b.SWRGet);return(0,p.useEffect)(()=>{if("undefined"!=typeof location){let e=new URLSearchParams(location.search);w(e.get("userId")||""),y(e.get("tab")||"changeInfo")}},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d(),{children:(0,s.jsx)("title",{children:b("changeInfo")+" - "+b("brand")})}),(0,s.jsx)("h3",{children:b("changeInfo")}),(0,s.jsxs)(o.Z,{variant:"underline",defaultActiveKey:j,onSelect:e=>{e&&y(e)},className:"mb-2",children:[(0,s.jsx)(o.Z.Item,{children:(0,s.jsx)(o.Z.Link,{eventKey:"changeInfo",children:b("changeInfo")})}),(0,s.jsx)(o.Z.Item,{children:(0,s.jsx)(o.Z.Link,{eventKey:"changeStudentName",children:b("changeStudentName")})}),(0,s.jsx)(o.Z.Item,{children:(0,s.jsx)(o.Z.Link,{eventKey:"changeStudentGender",children:b("changeStudentGender")})}),(0,s.jsx)(o.Z.Item,{children:(0,s.jsx)(o.Z.Link,{eventKey:"changePassword",children:b("changePassword")})})]}),"changeInfo"===j?(0,s.jsx)(l.J9,{validationSchema:i.Ry().shape({userId:i.Rx().typeError(b("requireNumber")).required(b("required")).min(1,b("min1")).max(38,b("max38")),username:i.Z_().typeError(b("requireString")).required(b("required")).min(4,b("minLen4")).max(16,b("maxLen16")),studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38"))}),onSubmit:e=>{u.b.Put("user",{params:{userId:parseInt(e.userId),username:e.username,studentId:parseInt(e.studentId)}},{showSuccess:!0})},initialValues:{userId:Z,username:(null==f?void 0:null===(e=f.user[0])||void 0===e?void 0:e.username)||"",studentId:(null==f?void 0:null===(n=f.user[0])||void 0===n?void 0:n.studentId)||""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:r,handleBlur:t,values:d,touched:a,errors:l}=e;return(0,s.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,s.jsxs)(m.Z,{controlId:"userId",label:b("userId"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("userId"),name:"userId",value:d.userId,onBlur:t,onChange:r,isInvalid:a.userId&&null!=l.userId,...""===Z?{}:{disabled:!0}}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.userId})]}),(0,s.jsxs)(m.Z,{controlId:"username",label:b("username"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("username"),name:"username",value:d.username,onBlur:t,onChange:r,isInvalid:a.username&&null!=l.username}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.username})]}),(0,s.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:d.studentId,onBlur:t,onChange:r,isInvalid:a.studentId&&null!=l.studentId}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,s.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changeStudentName"===j?(0,s.jsx)(l.J9,{validationSchema:i.Ry().shape({studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38")),studentName:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38"))}),onSubmit:e=>{u.b.Put("student",{params:{studentId:parseInt(e.studentId),studentName:e.studentName}},{showSuccess:!0})},initialValues:{studentId:(null==f?void 0:null===(r=f.user[0])||void 0===r?void 0:r.studentId)||"",studentName:(null==S?void 0:null===(t=S.student[0])||void 0===t?void 0:t.studentName)||""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:r,handleBlur:t,values:d,touched:a,errors:l}=e;return(0,s.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,s.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:d.studentId,onBlur:t,onChange:r,isInvalid:a.studentId&&null!=l.studentId,...""===Z?{}:{disabled:!0}}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,s.jsxs)(m.Z,{controlId:"studentName",label:b("studentName"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("studentName"),name:"studentName",value:d.studentName,onBlur:t,onChange:r,isInvalid:a.studentName&&null!=l.studentName}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentName})]}),(0,s.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changeStudentGender"===j?(0,s.jsx)(l.J9,{validationSchema:i.Ry().shape({studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38")),gender:i.Z_().typeError(b("requireString")).required(b("required")),psychologicalGender:i.Z_().typeError(b("requireString"))}),onSubmit:e=>{u.b.Put("student",{params:{studentId:parseInt(e.studentId),gender:"male"==e.gender,psychologicalGender:e.psychologicalGender}},{showSuccess:!0})},initialValues:{studentId:(null==f?void 0:null===(I=f.user[0])||void 0===I?void 0:I.studentId)||"",gender:(null==S?void 0:null===(v=S.student[0])||void 0===v?void 0:v.gender)?"male":"female",psychologicalGender:(null==S?void 0:null===(x=S.student[0])||void 0===x?void 0:x.psychologicalGender)||""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:r,handleBlur:t,values:d,touched:a,errors:l}=e;return(0,s.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,s.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:d.studentId,onBlur:t,onChange:r,isInvalid:a.studentId&&null!=l.studentId,...""===Z?{}:{disabled:!0}}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,s.jsxs)(m.Z,{controlId:"gender",label:b("gender"),className:"mb-3",children:[(0,s.jsxs)(c.Z.Select,{name:"gender",value:d.gender,onBlur:t,onChange:r,isInvalid:a.gender&&null!=l.gender,children:[(0,s.jsx)("option",{value:"male",...d.gender?{selected:!0}:{},children:b("male")}),(0,s.jsx)("option",{value:"female",...d.gender?{}:{selected:!0},children:b("female")})]}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.gender})]}),(0,s.jsxs)(m.Z,{controlId:"psychologicalGender",label:b("psychologicalGender"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{placeholder:b("psychologicalGender"),name:"psychologicalGender",value:d.psychologicalGender,onBlur:t,onChange:r,isInvalid:a.psychologicalGender&&null!=l.psychologicalGender}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.psychologicalGender})]}),(0,s.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changePassword"===j?(0,s.jsx)(l.J9,{validationSchema:i.Ry().shape({userId:i.Rx().typeError(b("requireNumber")).required(b("required")).min(1,b("min1")).max(38,b("max38")),password:i.Z_().typeError(b("requireString")).required(b("required")).min(8,b("minLen8")).max(64,b("maxLen64")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{}|;':",.<>\/?]).{8,64}$/,b("requireStrongPassword")),confirmPassword:i.Z_().typeError(b("requireString")).required(b("required")).oneOf([i.iH("password")],b("passwordNotMatch"))}),onSubmit:e=>{u.b.Put("user",{params:{userId:parseInt(e.userId),password:e.password}},{showSuccess:!0})},initialValues:{userId:Z,password:"",confirmPassword:""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:r,handleBlur:t,values:d,touched:a,errors:l}=e;return(0,s.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,s.jsxs)(m.Z,{controlId:"userId",label:b("userId"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{type:"number",placeholder:b("userId"),name:"userId",value:d.userId,onBlur:t,onChange:r,isInvalid:a.userId&&null!=l.userId,...""===Z?{}:{disabled:!0}}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.userId})]}),(0,s.jsxs)(m.Z,{controlId:"password",label:b("password"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{type:"password",placeholder:b("password"),name:"password",value:d.password,onBlur:t,onChange:r,isInvalid:a.password&&null!=l.password}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.password})]}),(0,s.jsxs)(m.Z,{controlId:"confirmPassword",label:b("confirmPassword"),className:"mb-3",children:[(0,s.jsx)(c.Z.Control,{type:"password",placeholder:b("confirmPassword"),name:"confirmPassword",value:d.confirmPassword,onBlur:t,onChange:r,isInvalid:a.confirmPassword&&null!=l.confirmPassword}),(0,s.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.confirmPassword})]}),(0,s.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):void 0]})}}},function(e){e.O(0,[368,4,888,774,179],function(){return e(e.s=8034)}),_N_E=e.O()}]);