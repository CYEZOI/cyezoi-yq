(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{5752:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/finance",function(){return n(4042)}])},8166:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var a=n(4961),s=n(5139);class r{static async request_url(e,t,n,r){let l=new URLSearchParams(n);return l.append("lang",localStorage.getItem("language")||"en"),l.append("token",localStorage.getItem("token")||""),fetch("/api/"+(t+=(t.includes("?")?"&":"?")+l.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},redirect:"manual"}).then(e=>e.json()).then(e=>(e.success?(r.showSuccess&&a.X.emit("newAlert",{message:e.message,variant:"success"}),r.success&&r.success(e.result)):(r.hideFailure||a.X.emit("newAlert",{message:e.message,variant:"danger"}),r.failure&&r.failure(e.result)),e.result)).catch(e=>{r.hideError||a.X.emit("newAlert",{message:(0,s.t)("networkError"),variant:"danger"}),r.error&&r.error(e)})}static async request_body(e,t,n,r){fetch("/api/"+t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:n.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""}),redirect:"manual"}).then(e=>e.json()).then(e=>{e.success?(r.showSuccess&&a.X.emit("newAlert",{message:e.message,variant:"success"}),r.success&&r.success(e.result)):(r.hideFailure||a.X.emit("newAlert",{message:e.message,variant:"danger"}),r.failure&&r.failure(e.result))}).catch(e=>{r.hideError||a.X.emit("newAlert",{message:(0,s.t)("networkError"),variant:"danger"}),r.error&&r.error(e)})}static async Get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.request_url("GET",e,t,n)}static async Post(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.request_body("POST",e,t,n)}static async Put(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.request_body("PUT",e,t,n)}static async Delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.request_url("DELETE",e,t,n)}static async SWRGet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((n,a)=>{r.Get(e,t,{success:e=>n(e),failure:e=>a(e),error:e=>a(e)})})}static success(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:t,result:n}),e.end())}static failure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:t,result:{}}),e.end())}}},4042:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var a=n(2676);n(5271);var s=n(8801),r=n(2737),l=n(631),i=n(9722),c=n(1228),d=n(5324),o=n(7976),u=n.n(o),h=n(5940),m=n(5837),x=n(8533),j=n(8166),g=n(9505),p=n(8705),y=n(389),f=n(3388),v=n(376),Z=n(380),b=n(1006),w=n(5093),k=n(4979),S=n(1791),C=n(3698);function q(){let{t:e}=d.default,{data:t,mutate:n}=(0,g.ZP)("finance",j.b.SWRGet),{data:o,mutate:q}=(0,g.ZP)("financeStatics",j.b.SWRGet),_=()=>{n(),q()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u(),{children:(0,a.jsx)("title",{children:e("finance")+" - "+e("brand")})}),(0,a.jsx)("h3",{children:e("finance")}),(0,a.jsx)(c.J9,{validationSchema:i.Ry().shape({type:i.Z_().required(e("required")),date:i.hT().typeError(e("requireDate")).required(e("required")),money:i.Rx().typeError(e("requireNumber")).required(e("required")).min(0,e("min0")).max(1e3,e("max1000")).not([0],e("required")),detail:i.Z_().typeError(e("requireString")).required(e("required")).min(8,e("minLen8")).max(64,e("maxLen64"))}),onSubmit:e=>{let t={date:e.date,money:parseInt(e.money)*("income"==e.type?1:-1),detail:e.detail};j.b.Post("finance",{params:t},{success:()=>{_()}})},initialValues:{type:"income",date:new Date().toISOString().split("T")[0],money:0,detail:""},children:t=>{let{handleSubmit:n,handleChange:i,handleBlur:c,values:d,touched:o,errors:u}=t;return(0,a.jsx)(r.Z,{noValidate:!0,onSubmit:n,children:(0,a.jsxs)(h.Z,{children:[(0,a.jsxs)(m.Z,{className:"col-3 col-sm-2 col-lg-1",children:[(0,a.jsx)(r.Z.Check,{type:"radio",name:"type",value:"income",onChange:i,label:e("income"),defaultChecked:!0,isInvalid:o.type&&null!=u.type}),(0,a.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.type})]}),(0,a.jsxs)(m.Z,{className:"col-3 col-sm-2 col-lg-1",children:[(0,a.jsx)(r.Z.Check,{type:"radio",name:"type",value:"expenditure",onChange:i,label:e("expenditure"),isInvalid:o.type&&null!=u.type}),(0,a.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.type})]}),(0,a.jsx)(m.Z,{className:"col-6 col-sm-4 col-lg-2",children:(0,a.jsxs)(l.Z,{hasValidation:!0,children:[(0,a.jsx)(l.Z.Text,{children:e("date")}),(0,a.jsx)(r.Z.Control,{type:"date",name:"date",value:d.date,onBlur:c,onChange:i,isInvalid:o.date&&null!=u.date}),(0,a.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.date})]})}),(0,a.jsx)(m.Z,{className:"col-12 col-sm-4 col-lg-2",children:(0,a.jsxs)(l.Z,{hasValidation:!0,children:[(0,a.jsx)(l.Z.Text,{children:e("amount")}),(0,a.jsx)(r.Z.Control,{placeholder:e("money"),name:"money",value:d.money,onBlur:c,onChange:i,isInvalid:o.money&&null!=u.money}),(0,a.jsx)(l.Z.Text,{children:e("RMB")}),(0,a.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.money})]})}),(0,a.jsx)(m.Z,{className:"col-12 col-sm-10 col-lg-4",children:(0,a.jsxs)(l.Z,{hasValidation:!0,children:[(0,a.jsx)(l.Z.Text,{children:e("reason")}),(0,a.jsx)(r.Z.Control,{placeholder:e("detail"),name:"detail",value:d.detail,onBlur:c,onChange:i,isInvalid:o.detail&&null!=u.detail}),(0,a.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.detail})]})}),(0,a.jsx)(m.Z,{className:"col-12 col-sm-2 col-lg-2",children:(0,a.jsx)(s.Z,{type:"submit",children:e("addButton")})})]})})}}),(0,a.jsx)(p.h,{width:"100%",height:300,children:(0,a.jsxs)(y.w,{width:600,height:300,data:o&&o.records,children:[(0,a.jsx)(f.q,{strokeDasharray:"3 3"}),(0,a.jsx)(v.K,{dataKey:"month"}),(0,a.jsx)(Z.B,{}),(0,a.jsx)(b.u,{}),(0,a.jsx)(w.x,{type:"monotone",dataKey:"balance",stroke:"#ff7300",name:e("balance")})]})}),(0,a.jsx)(p.h,{width:"100%",height:300,children:(0,a.jsxs)(k.v,{width:600,height:300,data:o&&o.records,children:[(0,a.jsx)(f.q,{strokeDasharray:"3 3"}),(0,a.jsx)(v.K,{dataKey:"month"}),(0,a.jsx)(Z.B,{}),(0,a.jsx)(b.u,{}),(0,a.jsx)(S.$,{dataKey:"income",fill:"#8884d8",name:e("income")}),(0,a.jsx)(S.$,{dataKey:"expenditure",fill:"#82ca9d",name:e("expenditure")}),(0,a.jsx)(w.x,{type:"monotone",dataKey:"balance",stroke:"#ff7300"})]})}),(0,a.jsxs)(x.Z,{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:e("date")}),(0,a.jsx)("th",{children:e("amount")}),(0,a.jsx)("th",{children:e("reason")}),(0,a.jsx)("th",{children:e("operation")})]})}),(0,a.jsx)("tbody",{children:t&&t.records.map(t=>(0,a.jsxs)("tr",{className:t.money>0?"table-success":"table-danger",children:[(0,a.jsx)("td",{children:new Date(t.date).toLocaleDateString()}),(0,a.jsxs)("td",{children:[t.money," ",e("RMB")]}),(0,a.jsx)("td",{children:t.detail}),(0,a.jsx)("td",{children:(0,a.jsxs)(s.Z,{onClick:()=>{j.b.Delete("finance",{financeId:t.financeId.toString()},{success:()=>{_()}})},variant:"danger",size:"sm",children:[(0,a.jsx)(C.Z,{className:"me-1"}),e("delete")]})})]},t.financeId))})]})]})}}},function(e){e.O(0,[368,517,34,888,774,179],function(){return e(e.s=5752)}),_N_E=e.O()}]);