(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[358],{2197:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/image",function(){return r(8680)}])},1105:function(e,t,r){"use strict";r.d(t,{UI:function(){return n},XW:function(){return s}});var a=r(5271);function n(e,t){let r=0;return a.Children.map(e,e=>a.isValidElement(e)?t(e,r++):e)}function s(e,t){return a.Children.toArray(e).some(e=>a.isValidElement(e)&&e.type===t)}},8166:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var a=r(4961),n=r(5139);class s{static async request_url(e,t,r,s){let l=new URLSearchParams(r);return l.append("lang",localStorage.getItem("language")||"en"),l.append("token",localStorage.getItem("token")||""),fetch("/api/"+(t+=(t.includes("?")?"&":"?")+l.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},redirect:"manual"}).then(e=>e.json()).then(e=>(e.success?(s.showSuccess&&a.X.emit("newAlert",{message:e.message,variant:"success"}),s.success&&s.success(e.result)):(s.hideFailure||a.X.emit("newAlert",{message:e.message,variant:"danger"}),s.failure&&s.failure(e.result)),e.result)).catch(e=>{s.hideError||a.X.emit("newAlert",{message:(0,n.t)("networkError"),variant:"danger"}),s.error&&s.error(e)})}static async request_body(e,t,r,s){fetch("/api/"+t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:r.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""}),redirect:"manual"}).then(e=>e.json()).then(e=>{e.success?(s.showSuccess&&a.X.emit("newAlert",{message:e.message,variant:"success"}),s.success&&s.success(e.result)):(s.hideFailure||a.X.emit("newAlert",{message:e.message,variant:"danger"}),s.failure&&s.failure(e.result))}).catch(e=>{s.hideError||a.X.emit("newAlert",{message:(0,n.t)("networkError"),variant:"danger"}),s.error&&s.error(e)})}static async Get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.request_url("GET",e,t,r)}static async Post(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.request_body("POST",e,t,r)}static async Put(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.request_body("PUT",e,t,r)}static async Delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.request_url("DELETE",e,t,r)}static async SWRGet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,a)=>{s.Get(e,t,{success:e=>r(e),failure:e=>a(e),error:e=>a(e)})})}static success(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:t,result:r}),e.end())}static failure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:t,result:{}}),e.end())}}},8680:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var a=r(2676),n=r(5271),s=r(5324),l=r(7976),i=r.n(l),c=r(8166),o=r(8801),u=r(2187),d=r.n(u),m=r(4982),g=r(1105);function f(e,t){let{min:r,now:n,max:s,label:l,visuallyHidden:i,striped:c,animated:o,className:u,style:m,variant:g,bsPrefix:f,...h}=e;return(0,a.jsx)("div",{ref:t,...h,role:"progressbar",className:d()(u,"".concat(f,"-bar"),{["bg-".concat(g)]:g,["".concat(f,"-bar-animated")]:o,["".concat(f,"-bar-striped")]:o||c}),style:{width:"".concat(Math.round((n-r)/(s-r)*1e5)/1e3,"%"),...m},"aria-valuenow":n,"aria-valuemin":r,"aria-valuemax":s,children:i?(0,a.jsx)("span",{className:"visually-hidden",children:l}):l})}let h=n.forwardRef((e,t)=>{let{isChild:r=!1,...s}=e,l={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...s};if(l.bsPrefix=(0,m.vE)(l.bsPrefix,"progress"),r)return f(l,t);let{min:i,now:c,max:o,label:u,visuallyHidden:h,striped:p,animated:v,bsPrefix:w,variant:y,className:j,children:b,...x}=l;return(0,a.jsx)("div",{ref:t,...x,className:d()(j,w),children:b?(0,g.UI)(b,e=>(0,n.cloneElement)(e,{isChild:!0})):f({min:i,now:c,max:o,label:u,visuallyHidden:h,striped:p,animated:v,bsPrefix:w,variant:y},t)})});h.displayName="ProgressBar";var p=r(1061),v=r(507),w=r.n(v),y=["color","size","title","className"];function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var b=(0,n.forwardRef)(function(e,t){var r=e.color,a=e.size,s=e.title,l=e.className,i=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,y);return n.createElement("svg",j({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:a,height:a,fill:r,className:["bi","bi-cloud-arrow-up",l].filter(Boolean).join(" ")},i),s?n.createElement("title",null,s):null,n.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708z"}),n.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383m.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"}))});b.propTypes={color:w().string,size:w().oneOfType([w().string,w().number]),title:w().string,className:w().string},b.defaultProps={color:"currentColor",size:"1em",title:null,className:""};var x=["color","size","title","className"];function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var O=(0,n.forwardRef)(function(e,t){var r=e.color,a=e.size,s=e.title,l=e.className,i=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,x);return n.createElement("svg",N({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:a,height:a,fill:r,className:["bi","bi-link",l].filter(Boolean).join(" ")},i),s?n.createElement("title",null,s):null,n.createElement("path",{d:"M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9q-.13 0-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"}),n.createElement("path",{d:"M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4 4 0 0 1-.82 1H12a3 3 0 1 0 0-6z"}))});O.propTypes={color:w().string,size:w().oneOfType([w().string,w().number]),title:w().string,className:w().string},O.defaultProps={color:"currentColor",size:"1em",title:null,className:""};var E=r(3698),S=r(9505),I=r(7208),P=r.n(I),z=r(4961);function k(){let{t:e}=s.default,{data:t,mutate:r}=(0,S.ZP)("image",c.b.SWRGet),{data:l}=(0,S.ZP)(()=>null==t||0==t.records.length?null:"user?userIdList="+t.records.map(e=>e.userId).join(","),c.b.SWRGet),[u,d]=(0,n.useState)(null),[m,g]=(0,n.useState)(!1),[f,v]=(0,n.useState)(0),[w,y]=(0,n.useState)(0),[j,x]=(0,n.useState)(0);var N=null;let I=e=>{var t=0;for(let a=0;a<e.length;a++){let n=e[a];if(0!==n.type.indexOf("image/"))continue;t++;let s=new FileReader;s.onload=async e=>{var t;if((null===(t=e.target)||void 0===t?void 0:t.result)==null)return;let a=e.target.result;await c.b.Post("image",{params:{image:a}},{success:()=>{r(),y(e=>e+1)},failure:()=>{x(e=>e+1)},error:()=>{x(e=>e+1)}})},s.readAsDataURL(n)}v(t)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:e("image")+" - "+e("brand")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:e("image")}),(0,a.jsx)("div",{className:"w-100 border border-2 rounded "+(m?"border-primary bg-secondary-subtle":"border-secondary"),onDragEnter:e=>{N=e.target,g(!0),e.preventDefault()},onDragLeave:e=>{e.target==N&&(g(!1),e.preventDefault())},onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault(),g(!1),I(e.dataTransfer.files)},children:(0,a.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center h-100 m-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(b,{className:"me-1"}),(0,a.jsxs)("span",{className:"d-none d-md-inline",children:[m?e("releaseToUpload"):e("dragToUpload"),(0,a.jsx)("span",{className:"ms-3",children:e("or")})]}),(0,a.jsx)(o.Z,{className:"ms-3",onClick:()=>{let e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="image/*",e.onchange=t=>{e.files&&I(e.files)},e.click()},children:e("selectFile")})]}),(0,a.jsxs)(h,{className:"w-100 mt-2",children:[(0,a.jsx)(h,{animated:!0,variant:"success",now:w,max:f},1),(0,a.jsx)(h,{animated:!0,variant:"danger",now:j,max:f},2)]})]})}),(0,a.jsxs)(p.Z,{show:null!=u,onHide:()=>d(null),children:[(0,a.jsx)(p.Z.Header,{closeButton:!0,children:(0,a.jsx)(p.Z.Title,{children:e("image")})}),(0,a.jsx)(p.Z.Body,{children:(()=>{var n;let s=null==t?void 0:t.records.find(e=>e.imageId==u);return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:s.image,alt:s.imageId,className:"w-100"}),(0,a.jsxs)("div",{className:"mt-3",children:[e("uploadUser")+e("colon"),l?null===(n=l.user.find(e=>e.userId==s.userId))||void 0===n?void 0:n.username:e("user")+s.userId]}),(0,a.jsxs)("div",{className:"mt-1",children:[e("createdAt")+e("colon"),new Date(s.createdAt).toLocaleString()]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)(o.Z,{onClick:()=>{navigator.clipboard.writeText(location.origin+"/api/image?imageId="+s.imageId),z.X.emit("newAlert",{variant:"success",message:e("copyLinkSuccess")})},variant:"outline-primary",size:"sm",className:"me-2",children:[(0,a.jsx)(O,{className:"me-1"}),e("copyLink")]}),(0,a.jsxs)(o.Z,{onClick:()=>{c.b.Delete("image",{imageId:s.imageId},{success:()=>{r(),d(null)},showSuccess:!0})},variant:"danger",size:"sm",children:[(0,a.jsx)(E.Z,{className:"me-1"}),e("delete")]})]})]}):null})()})]}),t&&(0,a.jsx)("div",{className:"d-flex flex-wrap mt-3",children:t.records.map(e=>(0,a.jsx)("div",{className:P().previewImage+" p-2",children:(0,a.jsx)("img",{src:e.image,alt:e.imageId,className:"rounded h-100",onClick:()=>{d(e.imageId)}})},e.imageId))})]})]})}},7208:function(e){e.exports={previewImage:"image_previewImage__DKfo6"}},3698:function(e,t,r){"use strict";var a=r(5271),n=r(507),s=r.n(n),l=["color","size","title","className"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var c=(0,a.forwardRef)(function(e,t){var r=e.color,n=e.size,s=e.title,c=e.className,o=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,l);return a.createElement("svg",i({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:n,height:n,fill:r,className:["bi","bi-trash",c].filter(Boolean).join(" ")},o),s?a.createElement("title",null,s):null,a.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),a.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))});c.propTypes={color:s().string,size:s().oneOfType([s().string,s().number]),title:s().string,className:s().string},c.defaultProps={color:"currentColor",size:"1em",title:null,className:""},t.Z=c}},function(e){e.O(0,[368,888,774,179],function(){return e(e.s=2197)}),_N_E=e.O()}]);