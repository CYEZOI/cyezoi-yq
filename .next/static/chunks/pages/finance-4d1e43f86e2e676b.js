(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{5752:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/finance",function(){return n(4042)}])},8166:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var s=n(4961);class a{static async request_url(e,t,n,a){let r=new URLSearchParams(n);return r.append("lang",localStorage.getItem("language")||"en"),r.append("token",localStorage.getItem("token")||""),fetch("/api/"+(t+=(t.includes("?")?"&":"?")+r.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(e=>(e.success?(s.X.emit("newAlert",{message:e.message,variant:"success"}),a.success&&a.success(e.result)):(s.X.emit("newAlert",{message:e.message,variant:"danger"}),a.failure&&a.failure(e.result)),e.result)).catch(e=>{s.X.emit("newAlert",{message:"API Error",variant:"danger"}),a.error&&a.error(e)})}static async request_body(e,t,n,a){fetch("/api/"+t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:n.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""})}).then(e=>e.json()).then(e=>{e.success?(s.X.emit("newAlert",{message:e.message,variant:"success"}),a.success&&a.success(e.result)):(s.X.emit("newAlert",{message:e.message,variant:"danger"}),a.failure&&a.failure(e.result))}).catch(e=>{s.X.emit("newAlert",{message:"API Error",variant:"danger"}),a.error&&a.error(e)})}static async Get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_url("GET",e,t,n)}static async Post(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_body("POST",e,t,n)}static async Put(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_body("PUT",e,t,n)}static async Delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_url("DELETE",e,t,n)}static async SWRGet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((n,s)=>{a.Get(e,t,{success:e=>n(e),failure:e=>s(e),error:e=>s(e)})})}static success(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:t,result:n}),e.end())}static failure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:t,result:{}}),e.end())}}},4042:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var s=n(2676);n(5271);var a=n(8801),r=n(4703),i=n(631),l=n(9722),c=n(1228),d=n(3232),o=n(7976),u=n.n(o),h=n(5940),m=n(5837),x=n(8533),j=n(8166),g=n(9505),f=n(8705),p=n(7074),y=n(3388),v=n(376),b=n(380),Z=n(1006),w=n(1791),_=n(5093);function S(){let{t:e}=d.default,{data:t,mutate:n}=(0,g.ZP)("finance",j.b.SWRGet),{data:o}=(0,g.ZP)("financeStatics",j.b.SWRGet);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u(),{children:(0,s.jsx)("title",{children:e("finance")+" - "+e("brand")})}),(0,s.jsx)("h3",{children:e("finance")}),(0,s.jsx)(c.J9,{validationSchema:l.Ry().shape({money:l.Rx().typeError(e("requireNumber")).required(e("required")).min(-1e3,e("min1000")).max(1e3,e("max1000")).not([0],e("required")),detail:l.Z_().typeError("requireString").required(e("required")).min(8,e("minLen8")).max(64,e("maxLen64"))}),onSubmit:e=>{j.b.Post("finance",{params:e}).then(e=>{n()})},initialValues:{money:0,detail:""},children:t=>{let{handleSubmit:n,handleChange:l,handleBlur:c,values:d,touched:o,errors:u}=t;return(0,s.jsx)(r.Z,{noValidate:!0,onSubmit:n,children:(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(m.Z,{children:(0,s.jsxs)(i.Z,{hasValidation:!0,children:[(0,s.jsx)(i.Z.Text,{children:e("amount")}),(0,s.jsx)(r.Z.Control,{placeholder:e("money"),name:"money",value:d.money,onBlur:c,onChange:l,isInvalid:o.money&&null!=u.money}),(0,s.jsx)(i.Z.Text,{children:e("RMB")}),(0,s.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.money})]})}),(0,s.jsx)(m.Z,{children:(0,s.jsxs)(i.Z,{hasValidation:!0,children:[(0,s.jsx)(i.Z.Text,{children:e("reason")}),(0,s.jsx)(r.Z.Control,{placeholder:e("detail"),name:"detail",value:d.detail,onBlur:c,onChange:l,isInvalid:o.detail&&null!=u.detail}),(0,s.jsx)(r.Z.Control.Feedback,{type:"invalid",children:u.detail})]})}),(0,s.jsx)(m.Z,{children:(0,s.jsx)(a.Z,{type:"submit",children:e("addButton")})})]})})}}),(0,s.jsx)(f.h,{width:"100%",height:300,children:(0,s.jsxs)(p.v,{width:600,height:300,data:o&&o.records,children:[(0,s.jsx)(y.q,{strokeDasharray:"3 3"}),(0,s.jsx)(v.K,{dataKey:"month"}),(0,s.jsx)(b.B,{}),(0,s.jsx)(Z.u,{}),(0,s.jsx)(w.$,{dataKey:"income",fill:"#8884d8"}),(0,s.jsx)(w.$,{dataKey:"outcome",fill:"#82ca9d"}),(0,s.jsx)(_.x,{type:"monotone",dataKey:"balance",stroke:"#ff7300"})]})}),(0,s.jsxs)(x.Z,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"col-2",children:e("id")}),(0,s.jsx)("th",{className:"col-2",children:e("time")}),(0,s.jsx)("th",{className:"col-2",children:e("amount")}),(0,s.jsx)("th",{className:"col-4",children:e("reason")}),(0,s.jsx)("th",{className:"col-2",children:e("operation")})]})}),(0,s.jsx)("tbody",{children:t&&t.records.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:t.financeId}),(0,s.jsx)("td",{children:new Date(t.createdAt).toLocaleString()}),(0,s.jsxs)("td",{children:[t.money," ",e("RMB")]}),(0,s.jsx)("td",{children:t.detail}),(0,s.jsx)("td",{children:(0,s.jsx)(a.Z,{onClick:()=>{j.b.Delete("finance",{financeId:t.financeId}).then(e=>{n()})},variant:"danger",size:"sm",children:e("delete")})})]},t.financeId))})]})]})}}},function(e){e.O(0,[368,4,805,888,774,179],function(){return e(e.s=5752)}),_N_E=e.O()}]);