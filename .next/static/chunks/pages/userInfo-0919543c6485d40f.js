(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{8034:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userInfo",function(){return s(4953)}])},8166:function(e,n,s){"use strict";s.d(n,{b:function(){return a}});var r=s(4961),t=s(5139);class a{static async request_url(e,n,s,a){let d=new URLSearchParams(s);return d.append("lang",localStorage.getItem("language")||"en"),d.append("token",localStorage.getItem("token")||""),fetch("/api/"+(n+=(n.includes("?")?"&":"?")+d.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(e=>(e.success?(a.showSuccess&&r.X.emit("newAlert",{message:e.message,variant:"success"}),a.success&&a.success(e.result)):(a.hideFailure||r.X.emit("newAlert",{message:e.message,variant:"danger"}),a.failure&&a.failure(e.result)),e.result)).catch(e=>{a.hideError||r.X.emit("newAlert",{message:(0,t.t)("networkError"),variant:"danger"}),a.error&&a.error(e)})}static async request_body(e,n,s,a){fetch("/api/"+n,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:s.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""})}).then(e=>e.json()).then(e=>{e.success?(a.showSuccess&&r.X.emit("newAlert",{message:e.message,variant:"success"}),a.success&&a.success(e.result)):(a.hideFailure||r.X.emit("newAlert",{message:e.message,variant:"danger"}),a.failure&&a.failure(e.result))}).catch(e=>{a.hideError||r.X.emit("newAlert",{message:(0,t.t)("networkError"),variant:"danger"}),a.error&&a.error(e)})}static async Get(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_url("GET",e,n,s)}static async Post(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_body("POST",e,n,s)}static async Put(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_body("PUT",e,n,s)}static async Delete(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.request_url("DELETE",e,n,s)}static async SWRGet(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((s,r)=>{a.Get(e,n,{success:e=>s(e),failure:e=>r(e),error:e=>r(e)})})}static success(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:n,result:s}),e.end())}static failure(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:n,result:{}}),e.end())}}},4953:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return g}});var r=s(2676),t=s(7976),a=s.n(t),d=s(5324),l=s(1228),i=s(9722),o=s(8166),u=s(3334),c=s(4703),m=s(4018),h=s(8801),I=s(5271),p=s(9505);function g(){var e,n,s,t,g,v,x;let{t:b}=d.default,[j,y]=(0,I.useState)("changeInfo"),[Z,f]=(0,I.useState)(""),{data:w}=(0,p.ZP)(Z?"user?userIdList="+Z:null,o.b.SWRGet),{data:S}=(0,p.ZP)(()=>w?"student?studentIdList="+w.user.map(e=>e.studentId).join(","):null,o.b.SWRGet);return(0,I.useEffect)(()=>{if("undefined"!=typeof location){let e=new URLSearchParams(location.search);f(e.get("userId")||""),y(e.get("tab")||"changeInfo")}},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:b("changeInfo")+" - "+b("brand")})}),(0,r.jsx)("h3",{children:b("changeInfo")}),(0,r.jsxs)(u.Z,{variant:"underline",defaultActiveKey:j,onSelect:e=>{e&&y(e)},className:"mb-2",children:[(0,r.jsx)(u.Z.Item,{children:(0,r.jsx)(u.Z.Link,{eventKey:"changeInfo",children:b("changeInfo")})}),(0,r.jsx)(u.Z.Item,{children:(0,r.jsx)(u.Z.Link,{eventKey:"changeStudentBasicInfo",children:b("changeStudentBasicInfo")})}),(0,r.jsx)(u.Z.Item,{children:(0,r.jsx)(u.Z.Link,{eventKey:"changeStudentInfo",children:b("changeStudentInfo")})}),(0,r.jsx)(u.Z.Item,{children:(0,r.jsx)(u.Z.Link,{eventKey:"changePassword",children:b("changePassword")})})]}),"changeInfo"===j?(0,r.jsx)(l.J9,{validationSchema:i.Ry().shape({userId:i.Rx().typeError(b("requireNumber")).required(b("required")).min(1,b("min1")).max(38,b("max38")),username:i.Z_().typeError(b("requireString")).required(b("required")).min(4,b("minLen4")).max(16,b("maxLen16")),studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38"))}),onSubmit:e=>{o.b.Put("user",{params:{userId:parseInt(e.userId),username:e.username,studentId:parseInt(e.studentId)}},{showSuccess:!0})},initialValues:{userId:Z,username:(null==w?void 0:null===(e=w.user[0])||void 0===e?void 0:e.username)||"",studentId:(null==w?void 0:null===(n=w.user[0])||void 0===n?void 0:n.studentId)||""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:s,handleBlur:t,values:a,touched:d,errors:l}=e;return(0,r.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,r.jsxs)(m.Z,{controlId:"userId",label:b("userId"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("userId"),name:"userId",value:a.userId,onBlur:t,onChange:s,isInvalid:d.userId&&null!=l.userId,...""===Z?{}:{disabled:!0}}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.userId})]}),(0,r.jsxs)(m.Z,{controlId:"username",label:b("username"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("username"),name:"username",value:a.username,onBlur:t,onChange:s,isInvalid:d.username&&null!=l.username}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.username})]}),(0,r.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:a.studentId,onBlur:t,onChange:s,isInvalid:d.studentId&&null!=l.studentId}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,r.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changeStudentBasicInfo"===j?(0,r.jsx)(l.J9,{validationSchema:i.Ry().shape({studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38")),studentName:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38")),gender:i.Z_().typeError(b("requireString")).required(b("required"))}),onSubmit:e=>{o.b.Put("student",{params:{studentId:parseInt(e.studentId),studentName:e.studentName,gender:"male"==e.gender}},{showSuccess:!0})},initialValues:{studentId:(null==w?void 0:null===(s=w.user[0])||void 0===s?void 0:s.studentId)||"",studentName:(null==S?void 0:null===(t=S.student[0])||void 0===t?void 0:t.studentName)||"",gender:(null==S?void 0:null===(g=S.student[0])||void 0===g?void 0:g.gender)?"male":"female"},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:s,handleBlur:t,values:a,touched:d,errors:l}=e;return(0,r.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,r.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:a.studentId,onBlur:t,onChange:s,isInvalid:d.studentId&&null!=l.studentId,...""===Z?{}:{disabled:!0}}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,r.jsxs)(m.Z,{controlId:"studentName",label:b("studentName"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("studentName"),name:"studentName",value:a.studentName,onBlur:t,onChange:s,isInvalid:d.studentName&&null!=l.studentName}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentName})]}),(0,r.jsxs)(m.Z,{controlId:"gender",label:b("gender"),className:"mb-3",children:[(0,r.jsxs)(c.Z.Select,{name:"gender",value:a.gender,onBlur:t,onChange:s,isInvalid:d.gender&&null!=l.gender,children:[(0,r.jsx)("option",{value:"male",...a.gender?{selected:!0}:{},children:b("male")}),(0,r.jsx)("option",{value:"female",...a.gender?{}:{selected:!0},children:b("female")})]}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.gender})]}),(0,r.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changeStudentInfo"===j?(0,r.jsx)(l.J9,{validationSchema:i.Ry().shape({studentId:i.Z_().typeError(b("requireString")).required(b("required")).min(1,b("min1")).max(38,b("max38")),psychologicalGender:i.Z_().typeError(b("requireString"))}),onSubmit:e=>{o.b.Put("student",{params:{studentId:parseInt(e.studentId),psychologicalGender:e.psychologicalGender}},{showSuccess:!0})},initialValues:{studentId:(null==w?void 0:null===(v=w.user[0])||void 0===v?void 0:v.studentId)||"",psychologicalGender:(null==S?void 0:null===(x=S.student[0])||void 0===x?void 0:x.psychologicalGender)||""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:s,handleBlur:t,values:a,touched:d,errors:l}=e;return(0,r.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,r.jsxs)(m.Z,{controlId:"studentId",label:b("studentId"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("studentId"),name:"studentId",value:a.studentId,onBlur:t,onChange:s,isInvalid:d.studentId&&null!=l.studentId,...""===Z?{}:{disabled:!0}}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.studentId})]}),(0,r.jsxs)(m.Z,{controlId:"psychologicalGender",label:b("psychologicalGender"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{placeholder:b("psychologicalGender"),name:"psychologicalGender",value:a.psychologicalGender,onBlur:t,onChange:s,isInvalid:d.psychologicalGender&&null!=l.psychologicalGender}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.psychologicalGender})]}),(0,r.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):"changePassword"===j?(0,r.jsx)(l.J9,{validationSchema:i.Ry().shape({userId:i.Rx().typeError(b("requireNumber")).required(b("required")).min(1,b("min1")).max(38,b("max38")),password:i.Z_().typeError(b("requireString")).required(b("required")).min(8,b("minLen8")).max(64,b("maxLen64")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{}|;':",.<>\/?]).{8,64}$/,b("requireStrongPassword")),confirmPassword:i.Z_().typeError(b("requireString")).required(b("required")).oneOf([i.iH("password")],b("passwordNotMatch"))}),onSubmit:e=>{o.b.Put("user",{params:{userId:parseInt(e.userId),password:e.password}},{showSuccess:!0})},initialValues:{userId:Z,password:"",confirmPassword:""},enableReinitialize:!0,children:e=>{let{handleSubmit:n,handleChange:s,handleBlur:t,values:a,touched:d,errors:l}=e;return(0,r.jsxs)(c.Z,{noValidate:!0,onSubmit:n,children:[(0,r.jsxs)(m.Z,{controlId:"userId",label:b("userId"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{type:"number",placeholder:b("userId"),name:"userId",value:a.userId,onBlur:t,onChange:s,isInvalid:d.userId&&null!=l.userId,...""===Z?{}:{disabled:!0}}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.userId})]}),(0,r.jsxs)(m.Z,{controlId:"password",label:b("password"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{type:"password",placeholder:b("password"),name:"password",value:a.password,onBlur:t,onChange:s,isInvalid:d.password&&null!=l.password}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.password})]}),(0,r.jsxs)(m.Z,{controlId:"confirmPassword",label:b("confirmPassword"),className:"mb-3",children:[(0,r.jsx)(c.Z.Control,{type:"password",placeholder:b("confirmPassword"),name:"confirmPassword",value:a.confirmPassword,onBlur:t,onChange:s,isInvalid:d.confirmPassword&&null!=l.confirmPassword}),(0,r.jsx)(c.Z.Control.Feedback,{type:"invalid",children:l.confirmPassword})]}),(0,r.jsx)(h.Z,{type:"submit",children:b("update")})]})}}):void 0]})}}},function(e){e.O(0,[368,4,888,774,179],function(){return e(e.s=8034)}),_N_E=e.O()}]);