(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{6415:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user",function(){return t(2399)}])},4074:function(e,r,t){"use strict";t.d(r,{Z:function(){return m}});var n=t(5271),s=t(2187),l=t.n(s),a=t(4982),i=t(5191);function o(e){let{animation:r,bg:t,bsPrefix:n,size:s,...o}=e;n=(0,a.vE)(n,"placeholder");let[{className:c,...u}]=(0,i.r)(o);return{...u,className:l()(c,r?"".concat(n,"-").concat(r):n,s&&"".concat(n,"-").concat(s),t&&"bg-".concat(t))}}var c=t(8801),u=t(2676);let d=n.forwardRef((e,r)=>{let t=o(e);return(0,u.jsx)(c.Z,{...t,ref:r,disabled:!0,tabIndex:-1})});d.displayName="PlaceholderButton";let h=n.forwardRef((e,r)=>{let{as:t="span",...n}=e,s=o(n);return(0,u.jsx)(t,{...s,ref:r})});h.displayName="Placeholder";var m=Object.assign(h,{Button:d})},8166:function(e,r,t){"use strict";t.d(r,{b:function(){return l}});var n=t(4961),s=t(5139);class l{static async request_url(e,r,t,l){let a=new URLSearchParams(t);return a.append("lang",localStorage.getItem("language")||"en"),a.append("token",localStorage.getItem("token")||""),fetch("/api/"+(r+=(r.includes("?")?"&":"?")+a.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},redirect:"manual"}).then(e=>e.json()).then(e=>(e.success?(l.showSuccess&&n.X.emit("newAlert",{message:e.message,variant:"success"}),l.success&&l.success(e.result)):(l.hideFailure||n.X.emit("newAlert",{message:e.message,variant:"danger"}),l.failure&&l.failure(e.result)),e.result)).catch(e=>{l.hideError||n.X.emit("newAlert",{message:(0,s.t)("networkError"),variant:"danger"}),l.error&&l.error(e)})}static async request_body(e,r,t,l){fetch("/api/"+r,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:t.params||{},lang:localStorage.getItem("language")||"en",token:localStorage.getItem("token")||""}),redirect:"manual"}).then(e=>e.json()).then(e=>{e.success?(l.showSuccess&&n.X.emit("newAlert",{message:e.message,variant:"success"}),l.success&&l.success(e.result)):(l.hideFailure||n.X.emit("newAlert",{message:e.message,variant:"danger"}),l.failure&&l.failure(e.result))}).catch(e=>{l.hideError||n.X.emit("newAlert",{message:(0,s.t)("networkError"),variant:"danger"}),l.error&&l.error(e)})}static async Get(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.request_url("GET",e,r,t)}static async Post(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.request_body("POST",e,r,t)}static async Put(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.request_body("PUT",e,r,t)}static async Delete(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.request_url("DELETE",e,r,t)}static async SWRGet(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((t,n)=>{l.Get(e,r,{success:e=>t(e),failure:e=>n(e),error:e=>n(e)})})}static success(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.writableEnded||(e.status(200).json({success:!0,message:r,result:t}),e.end())}static failure(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.writableEnded||(e.status(200).json({success:!1,message:r,result:{}}),e.end())}}},2399:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var n=t(2676),s=t(5271),l=t(5324),a=t(7976),i=t.n(a),o=t(9505),c=t(8166),u=t(2737),d=t(5940),h=t(5191),m=t(631),p=t(8801),g=t(8533),j=t(4074),x=t(1648),f=t(1228),v=t(9722),w=t(507),y=t.n(w),b=["color","size","title","className"];function Z(){return(Z=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var I=(0,s.forwardRef)(function(e,r){var t=e.color,n=e.size,l=e.title,a=e.className,i=function(e,r){if(null==e)return{};var t,n,s=function(e,r){if(null==e)return{};var t,n,s={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],r.indexOf(t)>=0||(s[t]=e[t]);return s}(e,r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}(e,b);return s.createElement("svg",Z({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:n,height:n,fill:t,className:["bi","bi-question",a].filter(Boolean).join(" ")},i),l?s.createElement("title",null,l):null,s.createElement("path",{d:"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"}))});I.propTypes={color:y().string,size:y().oneOfType([y().string,y().number]),title:y().string,className:y().string},I.defaultProps={color:"currentColor",size:"1em",title:null,className:""};var S=["color","size","title","className"];function N(){return(N=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var O=(0,s.forwardRef)(function(e,r){var t=e.color,n=e.size,l=e.title,a=e.className,i=function(e,r){if(null==e)return{};var t,n,s=function(e,r){if(null==e)return{};var t,n,s={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],r.indexOf(t)>=0||(s[t]=e[t]);return s}(e,r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}(e,S);return s.createElement("svg",N({ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:n,height:n,fill:t,className:["bi","bi-key",a].filter(Boolean).join(" ")},i),l?s.createElement("title",null,l):null,s.createElement("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),s.createElement("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"}))});O.propTypes={color:y().string,size:y().oneOfType([y().string,y().number]),title:y().string,className:y().string},O.defaultProps={color:"currentColor",size:"1em",title:null,className:""};var E=t(88),C=t(3698);function k(){let{t:e}=l.default,[r,t]=s.useState(null),[a,w]=s.useState(null);s.useEffect(()=>{let e=new URLSearchParams(window.location.search).get("userId");null!=e?t(parseInt(e)):t(null)},[]);let{data:y,mutate:b}=(0,o.ZP)(r?"user?userIdList="+r:"user",c.b.SWRGet),{data:Z,mutate:S}=(0,o.ZP)(()=>null==y?null:"student?studentIdList="+y.user.map(e=>e.studentId).join(","),c.b.SWRGet),N=()=>{b(),S()};if(null==r){var k;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i(),{children:(0,n.jsx)("title",{children:e("user")+" - "+e("brand")})}),(0,n.jsx)("h3",{children:e("user")}),(0,n.jsx)(f.J9,{validationSchema:v.Ry().shape({username:v.Z_().typeError(e("requireString")).required(e("required")).min(4,e("minLen4")).max(16,e("maxLen16")),password:v.Z_().typeError(e("requireString")).required(e("required")).min(8,e("minLen8")).max(64,e("maxLen64")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{}|;':",.<>\/?]).{8,64}$/,e("requireStrongPassword")),studentId:v.Rx().typeError(e("requireNumber")).required(e("required")).min(1,e("min1")).max(38,e("max38")),permission:v.Rx().typeError(e("requireNumber")).required(e("required")).min(0,e("min0"))}),onSubmit:e=>{c.b.Post("user",{params:e},{success:()=>{N()},showSuccess:!0})},initialValues:{username:"",password:"",studentId:0,permission:5},children:r=>{let{handleSubmit:t,handleChange:s,handleBlur:l,values:a,touched:i,errors:o}=r;return(0,n.jsx)(u.Z,{noValidate:!0,onSubmit:t,children:(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(h.Z,{children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(m.Z.Text,{children:e("username")}),(0,n.jsx)(u.Z.Control,{type:"text",name:"username",value:a.username,onChange:s,onBlur:l,isInvalid:i.username&&null!=o.username}),(0,n.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.username})]})}),(0,n.jsx)(h.Z,{children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(m.Z.Text,{children:e("password")}),(0,n.jsx)(u.Z.Control,{type:"password",name:"password",value:a.password,onChange:s,onBlur:l,isInvalid:i.password&&null!=o.password}),(0,n.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.password})]})}),(0,n.jsx)(h.Z,{children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(m.Z.Text,{children:e("studentId")}),(0,n.jsx)(u.Z.Control,{type:"number",name:"studentId",value:a.studentId,onChange:s,onBlur:l,isInvalid:i.studentId&&null!=o.studentId}),(0,n.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.studentId})]})}),(0,n.jsx)(h.Z,{children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(m.Z.Text,{children:e("permission")}),(0,n.jsx)(u.Z.Control,{type:"number",name:"permission",value:a.permission,onChange:s,onBlur:l,isInvalid:i.permission&&null!=o.permission}),(0,n.jsx)(u.Z.Control.Feedback,{type:"invalid",children:o.permission})]})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(p.Z,{type:"submit",children:e("create")})})]})})}}),(0,n.jsxs)(g.Z,{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:e("id")}),(0,n.jsx)("th",{children:e("username")}),(0,n.jsx)("th",{children:e("studentId")}),(0,n.jsx)("th",{children:e("studentName")}),(0,n.jsx)("th",{children:e("lastOnline")}),(0,n.jsx)("th",{children:e("operation")})]})}),(0,n.jsx)("tbody",{children:y&&y.user.map(r=>{var t;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:r.userId}),(0,n.jsx)("td",{children:r.username}),(0,n.jsx)("td",{children:r.studentId}),(0,n.jsx)("td",{children:Z?null===(t=Z.student.find(e=>e.studentId==r.studentId))||void 0===t?void 0:t.studentName:(0,n.jsx)(j.Z,{className:"ms-2",animation:"wave",children:(0,n.jsx)(j.Z,{as:h.Z,xs:12})})}),(0,n.jsx)("td",{children:new Date(r.lastOnline).toLocaleString()}),(0,n.jsxs)("td",{children:[(0,n.jsxs)(p.Z,{onClick:()=>{location.href="/userInfo?userId="+r.userId},variant:"outline-success",size:"sm",className:"me-2",children:[(0,n.jsx)(I,{className:"me-1"}),e("changeInfo")]}),(0,n.jsxs)(p.Z,{onClick:()=>{location.href="/permission?userId="+r.userId},variant:"outline-warning",size:"sm",className:"me-2",children:[(0,n.jsx)(O,{className:"me-1"}),e("permission")]}),(0,n.jsxs)(p.Z,{onClick:()=>{c.b.Delete("token",{userId:r.userId.toString()},{showSuccess:!0})},variant:"outline-danger",size:"sm",className:"me-2",children:[(0,n.jsx)(E.Z,{className:"me-1"}),e("logout")]}),(0,n.jsxs)(p.Z,{onClick:()=>{w(r.userId)},variant:"danger",size:"sm",children:[(0,n.jsx)(C.Z,{className:"me-1"}),e("delete")]})]})]},r.userId)})})]}),(0,n.jsxs)(x.Z,{show:null!=a,onHide:()=>w(null),size:"xl",children:[(0,n.jsx)(x.Z.Header,{closeButton:!0,children:(0,n.jsx)(x.Z.Title,{children:e("delete")})}),(0,n.jsx)(x.Z.Body,{children:e("deleteUserConfirm",{username:null==y?void 0:null===(k=y.user.find(e=>e.userId==a))||void 0===k?void 0:k.username})}),(0,n.jsxs)(x.Z.Footer,{children:[(0,n.jsx)(p.Z,{onClick:()=>{c.b.Delete("user",{userId:a.toString()},{success:()=>{N(),w(null)},showSuccess:!0})},variant:"danger",children:e("delete")}),(0,n.jsx)(p.Z,{onClick:()=>w(null),variant:"outline-secondary",children:e("cancel")})]})]})]})}}}},function(e){e.O(0,[368,517,281,888,774,179],function(){return e(e.s=6415)}),_N_E=e.O()}]);