"use strict";(()=>{var e={};e.id=254,e.ids=[254],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2021:e=>{e.exports=import("i18next")},7987:e=>{e.exports=import("react-i18next")},8210:e=>{e.exports=import("sequelize")},8411:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>o,default:()=>u,routeModule:()=>d});var n=a(808),i=a(7933),s=a(6130),c=a(3757),l=e([c]);c=(l.then?(await l)():l)[0];let u=(0,s.l)(c,"default"),o=(0,s.l)(c,"config"),d=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/financeStatics",pathname:"/api/financeStatics",bundlePath:"",filename:""},userland:c});r()}catch(e){r(e)}})},3757:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>u});var n=a(4570),i=a(4229),s=a(5076),c=a(2550),l=e([n,i,s,c]);async function u(e,t){if("GET"==e.method){if(s.Z.changeLanguage(e.query.lang||"en"),await c.r.checkToken(e.query.token)==null){n.b.failure(t,s.Z.t("unauthorized"));return}let a={records:[]};await i.yr.findAll().then(e=>{let r=0,i=0,c=0,l="";for(let t of e){let e=t.getDataValue("date").toString().slice(0,7);""==l&&(l=e),l!=e&&(a.records.push({month:l,income:r,expenditure:i,balance:c}),l=e,r=0,i=0),t.getDataValue("money")>0?r+=t.getDataValue("money"):i+=t.getDataValue("money"),c+=t.getDataValue("money")}a.records.push({month:l,income:r,expenditure:i,balance:c}),n.b.success(t,s.Z.t("financeStaticsGetSuccess"),a)}).catch(e=>{console.error(e),n.b.failure(t,s.Z.t("databaseError"))})}else n.b.failure(t,s.Z.t("invalidMethod"))}[n,i,s,c]=l.then?(await l)():l,r()}catch(e){r(e)}})},2550:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{r:()=>s});var n=a(4229),i=e([n]);n=(i.then?(await i)():i)[0];class s{static async checkToken(e){return await n.Qw.findOne({where:{token:e}}).then(async e=>{if(!e)return null;let t=e.getDataValue("userId");return await n.VK.update({lastOnline:new Date},{where:{userId:t}}),t}).catch(()=>null)}}r()}catch(e){r(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[840],()=>a(8411));module.exports=r})();