"use strict";(()=>{var e={};e.id=93,e.ids=[93],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2021:e=>{e.exports=import("i18next")},7987:e=>{e.exports=import("react-i18next")},8210:e=>{e.exports=import("sequelize")},9315:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>o,routeModule:()=>f});var i=r(808),n=r(7933),u=r(6130),l=r(7264),s=e([l]);l=(s.then?(await s)():s)[0];let o=(0,u.l)(l,"default"),d=(0,u.l)(l,"config"),f=new i.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/roleMember",pathname:"/api/roleMember",bundlePath:"",filename:""},userland:l});a()}catch(e){a(e)}})},7264:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>d});var i=r(4570),n=r(4229),u=r(5076),l=r(2550),s=r(2901),o=e([i,n,u,l]);async function d(e,t){if("GET"==e.method){if(u.Z.changeLanguage(e.query.lang||"en"),await l.r.checkToken(e.query.token)==null){i.b.failure(t,u.Z.t("unauthorized"));return}let f=e.query.studentIdList,c=e.query.roleIdList;var r=[],a=[];if("string"==typeof f)for(let e of f.split(",")){if(!s.h.isValidNumber(e)){i.b.failure(t,u.Z.t("invalidParameter"));return}r.push(parseInt(e))}if("string"==typeof c)for(let e of c.split(",")){if(!s.h.isValidNumber(e)){i.b.failure(t,u.Z.t("invalidParameter"));return}a.push(parseInt(e))}var o=[],d={};r.length>0&&(d.student=r),a.length>0&&(d.role=a),await n.h5.findAll({where:d}).then(e=>{for(let t of e)o.push({studentId:t.getDataValue("student"),role:[{roleId:t.getDataValue("role")}]})}),i.b.success(t,u.Z.t("roleMemberGetSuccess"),{student:o})}else if("POST"==e.method){let r=e.body;if(u.Z.changeLanguage(r.lang||"en"),await l.r.checkToken(r.token)==null){i.b.failure(t,u.Z.t("unauthorized"));return}let a=r.params.student,s=r.params.role,o=r.params.leader;if("number"!=typeof a||"number"!=typeof s||"number"!=typeof o){i.b.failure(t,u.Z.t("invalidParameter"));return}await n.h5.create({student:a,role:s,leader:o}).then(()=>{i.b.success(t,u.Z.t("roleMemberCreateSuccess"))})}else if("DELETE"==e.method){if(u.Z.changeLanguage(e.query.lang||"en"),await l.r.checkToken(e.query.token)==null){i.b.failure(t,u.Z.t("unauthorized"));return}let r=e.body.params.student,a=e.body.params.role;if("string"!=typeof r||!s.h.isValidNumber(r)||"string"!=typeof a||!s.h.isValidNumber(a)){i.b.failure(t,u.Z.t("invalidParameter"));return}await n.h5.destroy({where:{student:r,role:a}}).then(()=>{i.b.success(t,u.Z.t("roleMemberDeleteSuccess"))})}else i.b.failure(t,u.Z.t("invalidMethod"))}[i,n,u,l]=o.then?(await o)():o,a()}catch(e){a(e)}})},2901:(e,t,r)=>{r.d(t,{h:()=>a});class a{static isValidNumber(e,t=!1){let r=parseInt(e);return!isNaN(r)&&(t||r>=0)&&r!=-1/0&&r!=1/0}}}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[829],()=>r(9315));module.exports=a})();