"use strict";(()=>{var e={};e.id=994,e.ids=[994],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2021:e=>{e.exports=import("i18next")},7987:e=>{e.exports=import("react-i18next")},8210:e=>{e.exports=import("sequelize")},6130:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},3750:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>i,default:()=>l,routeModule:()=>p});var a=t(808),n=t(7933),o=t(6130),u=t(7026),c=e([u]);u=(c.then?(await c)():c)[0];let l=(0,o.l)(u,"default"),i=(0,o.l)(u,"config"),p=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/login",pathname:"/api/login",bundlePath:"",filename:""},userland:u});s()}catch(e){s(e)}})},8674:(e,r,t)=>{t.d(r,{b:()=>n});class s{listen(e,r){this.pipes[e]=r}emit(e,r=null){this.pipes[e]&&this.pipes[e](r)}constructor(){this.pipes={}}}let a=new s;class n{static async request_url(e,r,t,s){let n=new URLSearchParams(t);return n.append("lang",localStorage.getItem("language")||"en"),fetch("/api/"+(r+=(r.includes("?")?"&":"?")+n.toString()),{method:e,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>e.json()).then(e=>(e.success?(a.emit("newAlert",{message:e.message,variant:"success"}),s.success&&s.success(e.result)):(a.emit("newAlert",{message:e.message,variant:"danger"}),s.failure&&s.failure(e.result)),e.result)).catch(e=>{a.emit("newAlert",{message:"API Error",variant:"danger"}),s.error&&s.error(e)})}static async request_body(e,r,t,s){fetch("/api/"+r,{method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({params:t.params||{},lang:localStorage.getItem("language")||"en"})}).then(e=>e.json()).then(e=>{e.success?(a.emit("newAlert",{message:e.message,variant:"success"}),s.success&&s.success(e.result)):(a.emit("newAlert",{message:e.message,variant:"danger"}),s.failure&&s.failure(e.result))}).catch(e=>{a.emit("newAlert",{message:"API Error",variant:"danger"}),s.error&&s.error(e)})}static async Get(e,r={},t={}){return n.request_url("GET",e,r,t)}static async Post(e,r={},t={}){return n.request_body("POST",e,r,t)}static async Put(e,r={},t={}){return n.request_body("PUT",e,r,t)}static async Delete(e,r={},t={}){return n.request_url("DELETE",e,r,t)}static async SWRGet(e,r={}){return new Promise((t,s)=>{n.Get(e,r,{success:e=>t(e),failure:e=>s(e),error:e=>s(e)})})}static success(e,r="",t={}){e.writableEnded||(e.status(200).json({success:!0,message:r,result:t}),e.end())}static failure(e,r=""){e.writableEnded||(e.status(200).json({success:!1,message:r,result:{}}),e.end())}}},4229:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.d(r,{Bw:()=>m,CI:()=>c,VK:()=>y,h5:()=>d,io:()=>p,mt:()=>i,sJ:()=>l,yr:()=>u});var a=t(8210),n=e([a]);let o=new(a=(n.then?(await n)():n)[0]).Sequelize({dialect:"sqlite",storage:"db/yq.sqlite"}),u=o.define("finance",{financeId:{type:a.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0},money:{type:a.DataTypes.INTEGER,allowNull:!1},detail:{type:a.DataTypes.STRING,allowNull:!0}}),c=o.define("student",{studentId:{type:a.DataTypes.INTEGER,primaryKey:!0},studentName:{type:a.DataTypes.STRING,allowNull:!1},gender:{type:a.DataTypes.BOOLEAN,allowNull:!1}}),l=o.define("group",{groupId:{type:a.DataTypes.INTEGER,primaryKey:!0},groupName:{type:a.DataTypes.STRING,allowNull:!1}}),i=o.define("groupMember",{group:{type:a.DataTypes.INTEGER},student:{type:a.DataTypes.INTEGER},leader:{type:a.DataTypes.BOOLEAN,allowNull:!1}}),p=o.define("role",{roleId:{type:a.DataTypes.INTEGER,primaryKey:!0},roleName:{type:a.DataTypes.STRING,allowNull:!1}}),d=o.define("roleMember",{role:{type:a.DataTypes.INTEGER},student:{type:a.DataTypes.INTEGER}}),m=o.define("privilegeRecord",{privilegeRecordId:{type:a.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0},date:{type:a.DataTypes.STRING,allowNull:!1},student:{type:a.DataTypes.INTEGER,allowNull:!1},io:{type:a.DataTypes.BOOLEAN,allowNull:!1},type:{type:a.DataTypes.STRING,allowNull:!1},value:{type:a.DataTypes.INTEGER,allowNull:!1},reason:{type:a.DataTypes.STRING,allowNull:!0}}),y=o.define("user",{userId:{type:a.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0},username:{type:a.DataTypes.STRING,allowNull:!1},password:{type:a.DataTypes.STRING,allowNull:!1},studentId:{type:a.DataTypes.INTEGER,allowNull:!0}});o.sync(),s()}catch(e){s(e)}})},5076:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.d(r,{Z:()=>u});var a=t(2021),n=t(7987),o=e([a,n]);[a,n]=o.then?(await o)():o,a.default.use(n.initReactI18next).init({resources:{en:{translation:{404:"404 Not Found","404Description":"The page you are looking for is not found.",addButton:"Add",amount:"Amount",brand:"CYEZOI-YQ",colon:": ",comma:", ",databaseError:"Database error",delete:"Delete",detail:"Detail",error:"Error",errorDescription:"We are sorry, but an error has occurred. Please try again later. If the problem persists, please contact us. Thank you.",female:"Female",finance:"Finance",financeCreateSuccess:"Create finance record successfully",financeDeleteSuccess:"Delete finance record successfully",financeGetSuccess:"Get finance records successfully",financeUpdateSuccess:"Update finance record successfully",footer:"Powered by CYEZOI",gain:"Gain",gender:"Gender",group:"Group",groupGetSuccess:"Get group records successfully",groupMemberCreateSuccess:"Create group member record successfully",groupMemberGetSuccess:"Get group member records successfully",home:"Home",id:"ID",invalidMethod:"Invalid request method",language:"Language",login:"Login",loginSuccess:"Login successfully",logout:"Logout",lose:"Lose",male:"Male",max1000:"Maximum 1000",maxLen16:"Maximum length 16",maxLen64:"Maximum length 64",min1000:"Minimum -1000",minLen4:"Minimum length 4",minLen8:"Minimum length 8",money:"Money",operation:"Operation",password:"Password",privilegeRecord:"Privilege Record",privilegeRecordGetSuccess:"Get privilege record successfully",reason:"Reason",required:"Required",requireNumber:"Number required",requireString:"String required",requireStrongPassword:"Require at least one uppercase letter, one lowercase letter, one number and one special character.",resource:"Resource",RMB:"RMB",role:"Role",roleGetSuccess:"Get role records successfully",roleMemberCreateSuccess:"Create role member record successfully",roleMemberDeleteSuccess:"Delete role member record successfully",roleMemberGetSuccess:"Get role member records successfully",student:"Student",studentGetSuccess:"Get student records successfully",studentName:"Name",studentNumber:"Student Number",time:"Time",userGetSuccess:"Get user records successfully",username:"Username",userNotFound:"User not found",welcomeDescription:"Welcome to CYEZOI-YQ, the official website of the YQ class of Cao Yang No.2 Middle School.",groupId:"Group ID",groupName:"Group Name",action:"Action",enter:"Enter",back:"Back"}},zh:{translation:{404:"404 未找到","404Description":"您要查找的页面未找到。",addButton:"添加",amount:"金额",brand:"曹杨二中永强创新班",colon:"：",comma:"，",databaseError:"数据库错误",delete:"删除",detail:"详情",error:"错误",errorDescription:"很抱歉，发生了错误。请稍后再试。如果问题仍然存在，请与我们联系。谢谢。",female:"女",finance:"财务",financeCreateSuccess:"创建财务记录成功",financeDeleteSuccess:"删除财务记录成功",financeGetSuccess:"获取财务记录成功",financeUpdateSuccess:"更新财务记录成功",footer:"由曹杨二中信奥开发组提供技术支持",gain:"获得",gender:"性别",group:"组",groupGetSuccess:"获取组记录成功",groupMemberCreateSuccess:"创建组成员记录成功",groupMemberGetSuccess:"获取组成员记录成功",home:"首页",id:"编号",invalidMethod:"无效的请求方法",language:"语言",login:"登录",loginSuccess:"登录成功",logout:"登出",lose:"失去",male:"男",max1000:"最大值 1000",maxLen16:"最大长度 16",maxLen64:"最大长度 64",min1000:"最小值 -1000",minLen4:"最小长度 4",minLen8:"最小长度 8",money:"金额",operation:"操作",password:"密码",privilegeRecord:"陶片放逐",privilegeRecordGetSuccess:"获取陶片放逐记录成功",reason:"原因",required:"必填",requireNumber:"需要填写数字",requireString:"需要填写字符串",requireStrongPassword:"需要至少一个大写字母、一个小写字母、一个数字和一个特殊字符。",resource:"资源",RMB:"元",role:"角色",roleGetSuccess:"获取角色记录成功",roleMemberCreateSuccess:"创建角色成员记录成功",roleMemberDeleteSuccess:"删除角色成员记录成功",roleMemberGetSuccess:"获取角色成员记录成功",student:"学生",studentGetSuccess:"获取学生记录成功",studentName:"姓名",studentNumber:"学号",time:"时间",userGetSuccess:"获取用户记录成功",username:"用户名",userNotFound:"用户未找到",welcomeDescription:"欢迎来到曹杨二中永强创新班的官方网站。",groupId:"组编号",groupName:"组名",action:"操作",enter:"查看",back:"返回"}}},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});let u=a.default;s()}catch(e){s(e)}})},7026:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>c});var a=t(8674),n=t(4229),o=t(5076),u=e([n,o]);async function c(e,r){if("GET"==e.method){o.Z.changeLanguage(e.query.lang||"en");var t="",s="";e.query.username&&"string"==typeof e.query.username&&(t=e.query.username),e.query.password&&"string"==typeof e.query.password&&(s=e.query.password);var u=0;await n.VK.findOne({where:{username:t,password:s}}).then(e=>{if(e)u=e.getDataValue("userId");else{a.b.failure(r,o.Z.t("userNotFound"));return}}).catch(e=>{console.error(e),a.b.failure(r,o.Z.t("databaseError"))}),a.b.success(r,o.Z.t("loginSuccess"),{userId:u})}else a.b.failure(r,o.Z.t("invalidMethod"))}[n,o]=u.then?(await u)():u,s()}catch(e){s(e)}})},7933:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},808:(e,r,t)=>{e.exports=t(145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=3750);module.exports=t})();